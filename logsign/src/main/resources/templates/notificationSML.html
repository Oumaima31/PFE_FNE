<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Notifications | Tableau de bord</title>
    <link rel="stylesheet" href="/css/stylesml.css">
    <link rel="stylesheet" href="/css/notifications.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
</head>
<body>
    <header class="navbar">
        <!-- Section météo à gauche -->
        <div id="meteo" class="meteo-card">
            <span id="meteo-icon"></span>
            <div class="meteo-info">
                <span id="meteo-temp"></span>
                <span id="meteo-description"></span>
            </div>
        </div>
        <div id="real-time" class="time-card">
            <span id="current-date"></span>
            <span id="current-time"></span>
        </div>
        <!-- Bouton pour les écrans mobiles -->
        <button class="navbar-toggle" onclick="toggleNavbar()">
            <span></span>
            <span></span>    
        </button>
        <nav class="navbar-container">
            <a class="navbar-item" href="/auth/fneSML">
                <i class="fas fa-home"></i>
                <span>Accueil</span>
            </a>
            <a class="navbar-item" href="/auth/historiqueSML">
                <i class="fas fa-history"></i>
                <span>Historique des FNE</span>
            </a>
            <!-- Bouton de déconnexion -->
            <a class="navbar-item" href="/auth/index" onclick="logout(); return false;">
                <i class="fas fa-sign-out-alt"></i>
                <span>Déconnexion</span>
            </a>
        </nav>
    </header>

    <main class="container">
        <div class="page-header">
            <h1><i class="fas fa-bell"></i> Notifications</h1>
            <div class="header-actions">
                <div class="search-container">
                    <input type="text" id="searchInput" placeholder="Rechercher...">
                    <button id="searchBtn"><i class="fas fa-search"></i></button>
                </div>
                <div class="filter-container">
                    <select id="filterUrgence">
                        <option value="">Toutes les urgences</option>
                        <option value="haute">Haute</option>
                        <option value="moyenne">Moyenne</option>
                        <option value="basse">Basse</option>
                    </select>
                    <select id="filterMoyen">
                        <option value="">Tous les moyens</option>
                        <option value="email">Email</option>
                        <option value="sms">SMS</option>
                        <option value="système">Système</option>
                    </select>
                    <div class="date-time-filter">
                        <div class="filter-group">
                            <label for="dateFilter">Date:</label>
                            <input type="date" id="dateFilter">
                        </div>
                    </div>
                    <button id="filterBtn" class="btn btn-primary">Filtrer</button>
                    <button id="resetBtn" onclick="resetFilters()" class="btn btn-secondary">Réinitialiser</button>
                </div>
            </div>
        </div>

        <div class="card">
            <div class="table-responsive">
                <table id="notifications-table" class="data-table">
                    <thead>
                        <tr>
                            <th>ID</th>
                            <th>Date d'envoi</th>
                            <th>Moyen</th>
                            <th>Urgence</th>
                            <th>FNE ID</th>
                            <th>Contenu</th>
                            <th>Actions</th>
                        </tr>
                    </thead>
                    <tbody>
                        <!-- Les données seront chargées dynamiquement -->
                    </tbody>
                </table>
            </div>
            
            <div class="pagination">
                <button id="prevPage" disabled><i class="fas fa-chevron-left"></i> Précédent</button>
                <span id="pageInfo">Page 1 sur 1</span>
                <button id="nextPage" disabled>Suivant <i class="fas fa-chevron-right"></i></button>
            </div>
        </div>
    </main>

    <!-- Modal pour afficher les détails d'une notification -->
    <div id="notificationDetailsModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Détails de la notification <span id="modalNotificationId"></span></h2>
                <button class="close-modal" onclick="closeModal()">&times;</button>
            </div>
            <div class="modal-body">
                <div class="detail-grid">
                    <div class="detail-item">
                        <label>ID de la notification:</label>
                        <span id="detail-notification-id"></span>
                    </div>
                    <div class="detail-item">
                        <label>Date d'envoi:</label>
                        <span id="detail-date-envoi"></span>
                    </div>
                    <div class="detail-item">
                        <label>Moyen:</label>
                        <span id="detail-moyen" class="moyen-badge"></span>
                    </div>
                    <div class="detail-item">
                        <label>Urgence:</label>
                        <span id="detail-urgence" class="urgence-badge"></span>
                    </div>
                    <div class="detail-item">
                        <label>ID de l'utilisateur:</label>
                        <span id="detail-utilisateur-id"></span>
                    </div>
                    <div class="detail-item">
                        <label>ID de la FNE:</label>
                        <span id="detail-fne-id"></span>
                    </div>
                </div>
                
                <div class="detail-section">
                    <h3>Contenu de la notification</h3>
                    <div class="notification-content" id="detail-contenu">
                        <!-- Le contenu sera affiché ici -->
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="closeModal()">Fermer</button>
                <button id="viewFneBtn" class="btn btn-primary" onclick="voirFNE(currentFneId)">Voir la FNE</button>
            </div>
        </div>
    </div>

    <script src="/js/smlf.js"></script>
    <script src="/js/notS.js"></script>
    <script>
        // Mettre à jour la date et l'heure toutes les secondes
        setInterval(updateDateTime, 1000);
        // Afficher la date et l'heure immédiatement au chargement de la page
        updateDateTime();
        // Afficher Meteo
        fetchMeteo();
    </script>
</body>
</html>