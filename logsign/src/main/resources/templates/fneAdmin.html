<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Fiche de Notification d'Evénement (FNE)</title>
    <link rel="stylesheet" href="/css/styless.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
</head>
<body>
    <header class="navbar">
        <!-- Section météo à gauche -->
        <div id="meteo">
            <span id="meteo-icon"></span>
            <span id="meteo-temp"></span>
            <span id="meteo-description"></span>
        </div>
        <div id="real-time">
            <span id="current-date"></span>
            <span id="current-time"></span>
        </div>
        <!-- Bouton pour les écrans mobiles -->
        <button class="navbar-toggle" onclick="toggleNavbar()">
            <span></span>
            <span></span>    
        </button>
        <nav class="navbar-container">
            <!-- Bouton pour les FNE en attente -->
            <div class="navbar-item">
                <a href="/auth/fneEnAttente" class="navbar-link">
                    <i class="fas fa-list"></i>
                    <span>FNE En Attente</span>
                </a>
            </div>
            <!-- Bouton pour l'historique -->
            <div class="navbar-item">
                <a href="/auth/historique" class="navbar-link">
                    <i class="fas fa-history"></i> 
                    <span>Historique des FNE</span>
                </a>
            </div>
            <!-- Bouton pour les statistiques -->
            <div class="navbar-item">
                <a href="/auth/statistiques" class="navbar-link">
                    <i class="fas fa-chart-bar"></i> 
                    <span>Statistiques</span>
                </a>
            </div>
            <!-- Bouton pour la liste des utilisateurs -->
            <div class="navbar-item">
                <a href="/auth/adminutilisateurs" class="navbar-link">
                    <i class="fas fa-users"></i>
                    <span>Liste des Utilisateurs</span>
                </a>
            </div>
            <!-- Bouton de déconnexion -->
            <div class="navbar-item">
                <a href="/auth/logout" class="navbar-link">
                    <i class="fas fa-sign-out-alt"></i>
                    <span>Déconnexion</span>
                </a>
            </div>
        </nav>
    </header>
    
    <div id="notification" class="notification">
        <span id="notificationText"></span>
    </div>
    
    <div class="form-container">
        <div class="title-container">
            <img src="/image/oacaLogo.jpg" alt="Logo"> 
            <h1>Fiche de Notification d'Evénement (FNE)</h1>
        </div>

        <!-- Barre de progression -->
        <div class="progress-container">
            <div class="progress-bar">
                <div class="progress-step active" data-step="1">
                    <div class="step-number">1</div>
                    <div class="step-label">Général</div>
                </div>
                <div class="progress-step" data-step="2">
                    <div class="step-number">2</div>
                    <div class="step-label">Aéronef</div>
                </div>
                <div class="progress-step" data-step="3">
                    <div class="step-number">3</div>
                    <div class="step-label">Victimes</div>
                </div>
                <div class="progress-step" data-step="4">
                    <div class="step-number">4</div>
                    <div class="step-label">Météo</div>
                </div>
                <div class="progress-step" data-step="5">
                    <div class="step-number">5</div>
                    <div class="step-label">Équipement</div>
                </div>
                <div class="progress-step" data-step="6">
                    <div class="step-number">6</div>
                    <div class="step-label">Description</div>
                </div>
                <div class="progress-step" data-step="7">
                    <div class="step-number">7</div>
                    <div class="step-label">Finalisation</div>
                </div>
            </div>
        </div>

        <!-- IMPORTANT: Form with method POST and action to submit FNE -->
        <form action="/auth/submitFNEAdmin" method="POST" id="fneForm">
            <!-- Type d'événement et REF GNE -->
            <div class="event-type-container">
                <div class="event-type-selection">
                    <label for="type_evt">Type d'événement :</label>
                    <select id="type_evt" name="type_evt" onchange="updateRefGneNumber()">
                        <option value="">Sélectionnez un type</option>
                        <option value="accident">Accident (ACCID)</option>
                        <option value="incident_grave">Incident grave (ING)</option>
                        <option value="incident">Incident (INC)</option>
                        <option value="evt_technique">Evenement Technique (EVT)</option>
                    </select>
                </div>
                <div class="event-ref-selection">
                    <label for="REF_GNE">REF GNE :</label>
                    <select id="REF_GNE" name="REF_GNE">
                        <!-- Les options seront générées dynamiquement par JavaScript -->
                    </select>
                </div>
            </div>
            
            <!-- Sections du formulaire -->
            <div class="form-sections">
                <!-- Section 1: Informations générales -->
                <section class="form-section active" data-section="1">
                    <div class="section-header">
                        <h2><i class="fas fa-info-circle"></i> 1. Informations générales / معلومات عامة</h2>
                        <button type="button" class="section-toggle"><i class="fas fa-chevron-up"></i></button>
                    </div>
                    <div class="section-content">
                        <div class="form-grid">
                            <div class="form-group">
                                <label for="Organisme_concerné">1.1 Organisme concerné</label>
                                <input type="text" name="Organisme_concerné" id="Organisme_concerné" class="form-control">
                            </div>
                            <div class="form-group">
                                <label for="Date">1.2 Date</label>
                                <input type="date" name="Date" id="Date" class="form-control">
                            </div>
                            <div class="form-group">
                                <label for="heure_UTC">1.3 Heure UTC</label>
                                <input type="time" name="heure_UTC" id="heure_UTC" class="form-control">
                            </div>
                            <div class="form-group">
                                <label for="Lieu_EVT">1.4 Lieu de l'événement</label>
                                <input type="text" name="Lieu_EVT" id="Lieu_EVT" class="form-control">
                            </div>
                            <div class="form-group">
                                <label for="moyen_detection">1.5 Moyen de détection</label>
                                <input type="text" name="moyen_detection" id="moyen_detection" class="form-control">
                            </div>
                            <div class="form-group">
                                <label for="impacts_operationnels">1.6 Impacts opérationnels</label>
                                <input type="text" name="impacts_operationnels" id="impacts_operationnels" class="form-control">
                            </div>
                        </div>
                        <div class="section-nav">
                            <button type="button" class="btn-next" onclick="nextSection(1)">Suivant <i class="fas fa-arrow-right"></i></button>
                        </div>
                    </div>
                </section>
           
                <!-- Section 2: Aéronef(s) concerné(s) -->
                <section class="form-section" data-section="2">
                    <div class="section-header">
                        <h2><i class="fas fa-plane"></i> 2. Aéronef(s) concerné(s) / الطارات المعنية</h2>
                        <button type="button" class="section-toggle"><i class="fas fa-chevron-down"></i></button>
                    </div>
                    <div class="section-content">
                        <div class="table-responsive">
                            <table class="data-table">
                                <thead>
                                    <tr>
                                        <th>Indicatif</th>
                                        <th>Code SSR</th>
                                        <th>Type appareil</th>
                                        <th>Règles de vol</th>
                                        <th>Départ</th>
                                        <th>Arrivée</th>
                                        <th>Cap</th>
                                        <th>Alt. réel</th>
                                        <th>Alt. autorisé</th>
                                        <th>Vitesse</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td><input type="text" name="Indicatif_immatricultion" id="Indicatif_immatricultion" class="form-control"></td>
                                        <td><input type="text" name="code_ssr" id="code_ssr" class="form-control"></td>
                                        <td><input type="text" name="type_appareil" id="type_appareil" class="form-control"></td>
                                        <td>
                                            <select name="regles_vol" id="regles_vol" class="form-control">
                                                <option value="IFR">IFR</option>
                                                <option value="VFR">VFR</option>
                                                <option value="IFR/VFR">IFR/VFR</option>
                                                <option value="VFR/IFR">VFR/IFR</option>   
                                            </select>
                                        </td>
                                        <td><input type="text" name="terrain_depart" id="terrain_depart" class="form-control"></td>
                                        <td><input type="text" name="terrain_arrivée" id="terrain_arrivée" class="form-control"></td>
                                        <td><input type="text" name="cap" id="cap" class="form-control"></td>
                                        <td><input type="text" name="altitude_reel" id="altitude_reel" class="form-control"></td>
                                        <td><input type="text" name="altitude_autorise" id="altitude_autorise" class="form-control"></td>
                                        <td><input type="text" name="vitesse" id="vitesse" class="form-control"></td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                        <div class="section-nav">
                            <button type="button" class="btn-prev" onclick="prevSection(2)"><i class="fas fa-arrow-left"></i> Précédent</button>
                            <button type="button" class="btn-next" onclick="nextSection(2)">Suivant <i class="fas fa-arrow-right"></i></button>
                        </div>
                    </div>
                </section>

                <!-- Section 3: Nombre de victimes -->
                <section class="form-section" data-section="3">
                    <div class="section-header">
                        <h2><i class="fas fa-user-injured"></i> 3. Nombre estimatif des victimes / عدد الضحايا</h2>
                        <button type="button" class="section-toggle"><i class="fas fa-chevron-down"></i></button>
                    </div>
                    <div class="section-content">
                        <div class="form-grid victims-grid">
                            <div class="form-group">
                                <label for="passagers">Passagers</label>
                                <input type="number" name="passagers" id="passagers" class="form-control" min="0">
                            </div>
                            <div class="form-group">
                                <label for="personnel">Personnel</label>
                                <input type="number" name="personnel" id="personnel" class="form-control" min="0">
                            </div>
                            <div class="form-group">
                                <label for="equipage">Equipage</label>
                                <input type="number" name="equipage" id="equipage" class="form-control" min="0">
                            </div>
                            <div class="form-group">
                                <label for="autre">Autre</label>
                                <input type="number" name="autre" id="autre" class="form-control" min="0">
                            </div>
                        </div>
                        <div class="section-nav">
                            <button type="button" class="btn-prev" onclick="prevSection(3)"><i class="fas fa-arrow-left"></i> Précédent</button>
                            <button type="button" class="btn-next" onclick="nextSection(3)">Suivant <i class="fas fa-arrow-right"></i></button>
                        </div>
                    </div>
                </section>

                <!-- Section 4: Conditions météorologiques -->
                <section class="form-section" data-section="4">
                    <div class="section-header">
                        <h2><i class="fas fa-cloud-sun-rain"></i> 4. Conditions météorologiques / الأحوال الجوية</h2>
                        <button type="button" class="section-toggle"><i class="fas fa-chevron-down"></i></button>
                    </div>
                    <div class="section-content">
                        <div class="form-grid weather-grid">
                            <div class="form-group">
                                <label>Vent</label>
                                <div class="input-group">
                                    <div class="input-with-icon">
                                        <i class="fas fa-compass"></i>
                                        <input type="text" name="vent_direction" id="vent_direction" class="form-control" placeholder="Direction">
                                    </div>
                                    <div class="input-with-icon">
                                        <i class="fas fa-wind"></i>
                                        <input type="text" name="vent_vitesse" id="vent_vitesse" class="form-control" placeholder="Vitesse">
                                    </div>
                                </div>
                            </div>
                            <div class="form-group">
                                <label for="visibilite">Visibilité (m)</label>
                                <input type="number" name="visibilite" id="visibilite" class="form-control">
                            </div>
                            <div class="form-group">
                                <label for="nebulosite">Nébulosité</label>
                                <select name="nebulosite" id="nebulosite" class="form-control">
                                    <option value="BKN">BKN</option>
                                    <option value="SCT">SCT</option>
                                    <option value="FEW">FEW</option>
                                    <option value="SKC">SKC</option>
                                    <option value="CB">CB</option>                               
                                </select>
                            </div>
                            <div class="form-group">
                                <label for="precipitation">Précipitation</label>
                                <select name="precipitation" id="precipitation" class="form-control">
                                    <option value="Pluie">Pluie</option>
                                    <option value="Grêle">Grêle</option>
                                    <option value="Neige">Neige</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label for="autres_phenomenes">Autres phénomènes</label>
                                <input type="text" name="autres_phenomenes" id="autres_phenomenes" class="form-control">
                            </div>
                        </div>
                        <div class="section-nav">
                            <button type="button" class="btn-prev" onclick="prevSection(4)"><i class="fas fa-arrow-left"></i> Précédent</button>
                            <button type="button" class="btn-next" onclick="nextSection(4)">Suivant <i class="fas fa-arrow-right"></i></button>
                        </div>
                    </div>
                </section>

                <!-- Section 5: Matériel, installation ou équipement -->
                <section class="form-section" data-section="5">
                    <div class="section-header">
                        <h2><i class="fas fa-tools"></i> 5. Matériel, installation ou équipement / معدات أو تجهيزات أو أجهزة</h2>
                        <button type="button" class="section-toggle"><i class="fas fa-chevron-down"></i></button>
                    </div>
                    <div class="section-content">
                        <div class="form-grid">
                            <div class="form-group">
                                <label>L'événement implique une installation/équipement</label>
                                <div class="radio-group">
                                    <label class="radio-label">
                                        <input type="radio" name="evt_implique_installation_équipement" value="true">
                                        <span class="radio-text">Oui</span>
                                    </label>
                                    <label class="radio-label">
                                        <input type="radio" name="evt_implique_installation_équipement" value="false" checked>
                                        <span class="radio-text">Non</span>
                                    </label>
                                </div>
                            </div>
                            <div class="form-group">
                                <label for="type_installation_équipement">Type de l'installation ou de l'équipement</label>
                                <input type="text" name="type_installation_équipement" id="type_installation_équipement" class="form-control">
                            </div>
                            <div class="form-group">
                                <label for="nom_compagnie_assistance_organisme_exploitant_véhicule">Compagnie d'assistance / organisme exploitant</label>
                                <input type="text" name="nom_compagnie_assistance_organisme_exploitant_véhicule" id="nom_compagnie_assistance_organisme_exploitant_véhicule" class="form-control">
                            </div>
                            <div class="form-group">
                                <label>L'événement implique un véhicule ou un matériel d'assistance au sol</label>
                                <div class="radio-group">
                                    <label class="radio-label">
                                        <input type="radio" name="evt_implique_véhicule_materiel_assistance_sol" value="true">
                                        <span class="radio-text">Oui</span>
                                    </label>
                                    <label class="radio-label">
                                        <input type="radio" name="evt_implique_véhicule_materiel_assistance_sol" value="false" checked>
                                        <span class="radio-text">Non</span>
                                    </label>
                                </div>
                            </div>
                            <div class="form-group">
                                <label for="type_materiel_véhicule">Type du matériel / véhicule</label>
                                <input type="text" name="type_materiel_véhicule" id="type_materiel_véhicule" class="form-control">
                            </div>
                        </div>
                        <div class="section-nav">
                            <button type="button" class="btn-prev" onclick="prevSection(5)"><i class="fas fa-arrow-left"></i> Précédent</button>
                            <button type="button" class="btn-next" onclick="nextSection(5)">Suivant <i class="fas fa-arrow-right"></i></button>
                        </div>
                    </div>
                </section>

                <!-- Section 6: Description de l'événement -->
                <section class="form-section" data-section="6">
                    <div class="section-header">
                        <h2><i class="fas fa-file-alt"></i> 6. Description de l'événement / وصف الحدث</h2>
                        <button type="button" class="section-toggle"><i class="fas fa-chevron-down"></i></button>
                    </div>
                    <div class="section-content">
                        <div class="form-group">
                            <label for="description_evt">Description détaillée (croquis si nécessaire)</label>
                            <textarea name="description_evt" id="description_evt" rows="8" class="form-control"></textarea>
                        </div>
                        <div class="section-nav">
                            <button type="button" class="btn-prev" onclick="prevSection(6)"><i class="fas fa-arrow-left"></i> Précédent</button>
                            <button type="button" class="btn-next" onclick="nextSection(6)">Suivant <i class="fas fa-arrow-right"></i></button>
                        </div>
                    </div>
                </section>

                <!-- Section 7: Finalisation -->
                <section class="form-section" data-section="7">
                    <div class="section-header">
                        <h2><i class="fas fa-check-circle"></i> 7. Finalisation</h2>
                        <button type="button" class="section-toggle"><i class="fas fa-chevron-down"></i></button>
                    </div>
                    <div class="section-content">
                        <div class="form-grid">
                            <div class="form-group">
                                <label for="nom_rédacteur">Nom du (ou des) rédacteur(s)</label>
                                <input type="text" name="nom_rédacteur" id="nom_rédacteur" class="form-control">
                            </div>
                            <div class="form-group">
                                <label for="statut">Statut de la FNE</label>
                                <select name="statut" id="statut" class="form-control">
                                    <option value="En attente">En attente</option>
                                    <option value="Validé">Validé</option>
                                    <option value="Rejeté">Rejeté</option>
                                    <option value="En cours de traitement">En cours de traitement</option>
                                </select>
                            </div>
                        </div>
                        <div class="form-summary">
                            <h3><i class="fas fa-clipboard-list"></i> Résumé de la notification</h3>
                            <div id="formSummary" class="summary-content">
                                <!-- Le résumé sera généré dynamiquement par JavaScript -->
                            </div>
                        </div>
                        <div class="section-nav">
                            <button type="button" class="btn-prev" onclick="prevSection(7)"><i class="fas fa-arrow-left"></i> Précédent</button>
                            <button type="submit" class="btn-submit"><i class="fas fa-paper-plane"></i> Soumettre la notification</button>
                        </div>
                    </div>
                </section>
            </div>
        </form>
    </div>
       
    <footer class="footer">
        <div class="footer-content">
            <p>
                La Fiche de Notification d'Evénement (FNE) est un document utilisé pour signaler et enregistrer les événements liés à la sécurité aérienne. Elle permet de collecter des informations précises pour analyser et prévenir les incidents futurs.
            </p>
            <div class="contact-info">
                <p>
                    <i class="fab fa-whatsapp"></i> Contactez-nous sur WhatsApp : <a href="https://wa.me/1234567890" target="_blank">+123 456 7890</a>
                </p>
                <p>
                    <i class="fas fa-globe"></i> Visitez le site web de l'OACA : <a href="https://www.oaca.nat.tn" target="_blank">www.oaca.ma</a>
                </p>
            </div>
        </div>
    </footer>

    <script src="/js/scripts.js"></script>
    <script>
        // Mettre à jour la date et l'heure toutes les secondes
        setInterval(updateDateTime, 1000);
        // Afficher la date et l'heure immédiatement au chargement de la page
        updateDateTime();
        // Afficher Meteo
        fetchMeteo();
    </script>
</body>
</html>