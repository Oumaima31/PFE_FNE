<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Fiche de Notification d'Ev√©nement (FNE)</title>
    <link rel="stylesheet" href="/css/styleS.css">
    <link rel="stylesheet" href="/css/fne-enhanced.css">
    <link rel="stylesheet" href="/css/sidebar-enhanced.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
</head>
<!-- Zone du Chatbot -->
<div id="chatbot-container" class="chatbot-container">
    <div id="chatbot-header" onclick="toggleChatbot()">ü§ñ Besoin d'aide ?</div>
    <div id="chatbot-body" style="display:none;">
        <div id="chat-log" class="chat-log"></div>
        <input type="text" id="chat-input" placeholder="Posez votre question..." onkeypress="if(event.key==='Enter') sendQuestion()">
    </div>
</div>

<style>
.chatbot-container {
    position: fixed;
    bottom: 0;
    right: 20px;
    width: 300px;
    font-family: Arial;
    z-index: 1000;
}

#chatbot-header {
    background-color: #007bff;
    color: white;
    padding: 10px;
    cursor: pointer;
    border-radius: 10px 10px 0 0;
}

#chatbot-body {
    border: 1px solid #007bff;
    background: white;
    height: 300px;
    overflow-y: auto;
    padding: 10px;
    border-radius: 0 0 10px 10px;
}

.chat-log {
    height: 240px;
    overflow-y: auto;
    margin-bottom: 10px;
}

.chat-log p {
    margin: 5px 0;
}

#chat-input {
    width: 100%;
    padding: 8px;
}
</style>
<script>
    function toggleChatbot() {
    const body = document.getElementById("chatbot-body");
    body.style.display = body.style.display === "none" ? "block" : "none";
    
    // Ajouter un message de bienvenue s'il n'y en a pas d√©j√† un
    const chatLog = document.getElementById("chat-log");
    if (chatLog.innerHTML === "") {
        chatLog.innerHTML = `<div class="bot-message">
            <strong>Assistant GNE:</strong> 
            <div style='background-color: #e6f7ff; border-left: 4px solid #1890ff; padding: 15px; border-radius: 4px; margin: 10px 0;'>
                <p style='margin: 0; color: #003a8c;'>Bonjour ! Je suis votre assistant pour le Guide de Notification des √âv√©nements (GNE). Comment puis-je vous aider ?</p>
            </div>
        </div>`;
    }
}

function sendQuestion() {
    const input = document.getElementById("chat-input");
    const question = input.value.trim();
    if (!question) return;

    const chatLog = document.getElementById("chat-log");
    chatLog.innerHTML += `<div class="user-message"><strong>Vous:</strong> ${question}</div>`;
    input.value = '';

    // Afficher un indicateur de chargement
    chatLog.innerHTML += `<div id="loading" class="bot-message">
        <strong>Assistant GNE:</strong> 
        <div style='background-color: #f0f0f0; border-left: 4px solid #d9d9d9; padding: 15px; border-radius: 4px; margin: 10px 0;'>
            <p style='margin: 0; color: #595959;'><em>Recherche dans le guide GNE...</em></p>
        </div>
    </div>`;
    chatLog.scrollTop = chatLog.scrollHeight;

    fetch("/api/chatbot", {
        method: "POST",
        headers: {
            "Content-Type": "application/json"
        },
        body: JSON.stringify(question)
    })
    .then(response => response.text())
    .then(response => {
        // Supprimer l'indicateur de chargement
        document.getElementById("loading")?.remove();
        
        // Ajouter la r√©ponse format√©e
        chatLog.innerHTML += `<div class="bot-message"><strong>Assistant GNE:</strong> ${response}</div>`;
        chatLog.scrollTop = chatLog.scrollHeight;
    })
    .catch(err => {
        document.getElementById("loading")?.remove();
        chatLog.innerHTML += `<div class="bot-message">
            <strong>Assistant GNE:</strong> 
            <div style='background-color: #fff1f0; border-left: 4px solid #ff4d4f; padding: 15px; border-radius: 4px; margin: 10px 0;'>
                <p style='margin: 0; color: #a8071a;'>Erreur de connexion au serveur. Veuillez r√©essayer.</p>
            </div>
        </div>`;
        chatLog.scrollTop = chatLog.scrollHeight;
    });
}
    </script>
    

<body>
    <header class="navbar">
        <!-- Section m√©t√©o √† gauche -->
        <div id="meteo">
            <span id="meteo-icon"></span>
            <span id="meteo-temp"></span>
            <span id="meteo-description"></span>
        </div>
        <div id="real-time">
            <span id="current-date"></span>
            <span id="current-time"></span>
        </div>
        <!-- Bouton pour les √©crans mobiles -->
        <button class="navbar-toggle" onclick="toggleNavbar()">
            <span></span>
            <span></span>    
        </button>
    </header>

    <!-- Nouvelle structure avec sidebar -->
    <div class="page-wrapper">
        <!-- Sidebar pour la navigation -->
        <div class="sidebar">
            <div class="sidebar-header">
                <img src="/image/oacaLogo.jpg" alt="Logo OACA" class="sidebar-logo">
                <h3>Menu de Navigation</h3>
            </div>
            <nav class="sidebar-nav">
                <!-- Bouton pour les FNE en attente -->
                <div class="sidebar-item">
                    <a href="/auth/fneEnAttente" class="sidebar-link">
                        <i class="fas fa-list"></i>
                        <span>FNE En Attente</span>
                    </a>
                </div>
                <!-- Bouton pour l'historique -->
                <div class="sidebar-item">
                    <a href="/auth/historique" class="sidebar-link">
                        <i class="fas fa-history"></i> 
                        <span>Historique des FNE</span>
                    </a>
                </div>
                <!-- Bouton pour les statistiques -->
                <div class="sidebar-item">
                    <a href="/auth/statistiques" class="sidebar-link">
                        <i class="fas fa-chart-bar"></i> 
                        <span>Statistiques</span>
                    </a>
                </div>
                <!-- Bouton pour la liste des utilisateurs -->
                <div class="sidebar-item">
                    <a href="/auth/adminutilisateurs" class="sidebar-link">
                        <i class="fas fa-users"></i>
                        <span>Liste des Utilisateurs</span>
                    </a>
                </div>
                <div class="sidebar-item">
                    <a href="/auth/notificationsAdmin" class="sidebar-link">
                        <i class="fas fa-bell"></i>
                        <span>Notifications</span>
                    </a>
                </div>
                <!-- Bouton de d√©connexion -->
                <div class="sidebar-item">
                    <a href="/auth/" class="sidebar-link" onclick="logout(); return false;">
                        <i class="fas fa-sign-out-alt"></i>
                        <span>D√©connexion</span>
                    </a>
                </div>
            </nav>
        </div>
        
        <!-- Overlay pour fermer le sidebar sur mobile -->
     <div class="sidebar-overlay" onclick="toggleNavbar()"></div>
        
        <!-- Contenu principal -->
    <div class="main-content">
    
        <div id="notification" class="notification">
            <span id="notificationText"></span>
        </div>
    
        <div class="form-container">
        <div class="title-container">
            <img src="/image/oacaLogo.jpg" alt="Logo"> 
            <h1>Fiche de Notification d'Ev√©nement (FNE)</h1>
        </div>
        
        <!-- Formulaire avec method POST et action pour soumettre FNE -->
        <form action="/auth/submitFNEAdmin" method="POST" id="fneForm">
            <!-- Add a hidden input for the FNE ID if we're editing -->
            <input type="hidden" id="fne_id" name="fne_id" th:if="${fne != null}" th:value="${fne.fne_id}" />
            <div class="section type-selection">
                <!-- Types d'√©v√©nements -->
                <div class="form-group">
                    <label for="type_evt">Type d'√©v√©nement :</label>
                    <select id="type_evt" name="type_evt" onchange="updateRefGneNumber()" class="enhanced-select">
                        <option value="">S√©lectionnez un type</option>
                        <option value="accident">Accident (ACCID)</option>
                        <option value="incident_grave">Incident grave (ING)</option>
                        <option value="incident">Incident (INC)</option>
                        <option value="evt_technique">Evenement Technique (EVT)</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label for="ref_gne">REF GNE :</label>
                    <select id="ref_gne" name="ref_gne" class="enhanced-select">
                        <!-- Les options seront g√©n√©r√©es dynamiquement par JavaScript -->
                    </select>
                </div>
            </div>
            
            <!-- Section 1: Informations g√©n√©rales -->
            <section class="collapsible-section">
                <div class="section-header" onclick="toggleSection(this)">
                    <h2><i class="fas fa-info-circle"></i> 1. Informations g√©n√©rales / ŸÖÿπŸÑŸàŸÖÿßÿ™ ÿπÿßŸÖÿ©</h2>
                    <span class="toggle-icon"><i class="fas fa-chevron-down"></i></span>
                </div>
                <div class="section-content">
                    <table>
                        <tr>
                            <td>1.1 Organisme concern√©</td>
                            <td><input type="text" name="Organisme_concern√©" id="Organisme_concern√©" class="enhanced-input"></td>
                        </tr>
                        <tr>
                            <td>1.2 Date</td>
                            <td><input type="date" name="Date" id="Date" class="enhanced-input"></td>
                        </tr>
                        <tr>
                            <td>1.3 Heure UTC</td>
                            <td><input type="time" name="heure_UTC" id="heure_UTC" class="enhanced-input"></td>
                        </tr>
                        <tr>
                            <td>1.4 Lieu de l'√©v√©nement</td>
                            <td><input type="text" name="Lieu_EVT" id="Lieu_EVT" class="enhanced-input"></td>
                        </tr>
                        <tr>
                            <td>1.5 Moyen de d√©tection</td>
                            <td><input type="text" name="moyen_detection" id="moyen_detection" class="enhanced-input"></td>
                        </tr>
                        <tr>
                            <td>1.6 Impacts op√©rationnels</td>
                            <td><input type="text" name="impacts_operationnels" id="impacts_operationnels" class="enhanced-input"></td>
                        </tr>
                    </table>
                </div>
            </section>

            <!-- Section 2: A√©ronef(s) concern√©(s) -->
            <section class="collapsible-section">
                <div class="section-header" onclick="toggleSection(this)">
                    <h2><i class="fas fa-plane"></i> 2. A√©ronef(s) concern√©(s) / ÿßŸÑÿ∑ÿßÿ±ÿßÿ™ ÿßŸÑŸÖÿπŸÜŸäÿ©</h2>
                    <span class="toggle-icon"><i class="fas fa-chevron-down"></i></span>
                </div>
                <div class="section-content">
                    <!-- Ligne A -->
                    <h3>A. Premier a√©ronef</h3>
                    <div class="table-responsive">
                        <table>
                            <tr>
                                <th>Indicatif et immatriculation</th>
                                <th>Code SSR</th>
                                <th>Type appareil</th>
                                <th>R√®gles de vol</th>
                                <th>Terrain d√©part</th>
                                <th>Terrain arriv√©e</th>
                                <th>Cap</th>
                                <th>Altitude/FL r√©el</th>
                                <th>Altitude/FL autoris√©</th>
                                <th>Vitesse</th>
                            </tr>
                            <tr>
                                <td>
                                    <input type="text" name="indicatif_immatricultion" id="indicatif_immatricultion" class="enhanced-input" maxlength="8" onblur="validateIndicatif('indicatif_immatricultion', 'indicatif_error')">
                                    <div id="indicatif_error" class="error_message" style="display: none; color: red; font-size: 0.8em;">
                                        Veuillez entrer un indicateur valide (8 caract√®res)
                                    </div>
                                </td>
                                <td>
                                    <input type="text" name="code_ssr" id="code_ssr" class="enhanced-input" maxlength="4" onblur="validateMaxLength('code_ssr', 'ssr_error', 4)">
                                    <div id="ssr_error" class="error_message" style="display: none; color: red; font-size: 0.8em;">
                                        Veuillez entrer un code valide (4 caract√®res)
                                    </div>
                                </td>
                                <td>
                                    <input type="text" name="type_appareil" id="type_appareil" class="enhanced-input" maxlength="4" onblur="validateMaxLength('type_appareil', 'type_appareil_error', 4)">
                                    <div id="type_appareil_error" class="error_message" style="display: none; color: red; font-size: 0.8em;">
                                        Veuillez entrer un type valide (4 caract√®res)
                                    </div>
                                </td>
                                    <td>
                                    <select name="regles_vol" id="regles_vol" class="enhanced-select">
                                        <option value=""></option>
                                        <option value="IFR">IFR</option>
                                        <option value="VFR">VFR</option>
                                        <option value="IFR/VFR">IFR/VFR</option>
                                        <option value="VFR/IFR">VFR/IFR</option>   
                                    </select>
                                </td>
                                <td><input type="text" name="terrain_depart" id="terrain_depart" class="enhanced-input"></td>
                                <td><input type="text" name="terrain_arriv√©e" id="terrain_arriv√©e" class="enhanced-input"></td>
                                <td><input type="text" name="cap" id="cap" class="enhanced-input"></td>
                                <td>
                                    <select name="altitude_reel" id="altitude_reel" class="enhanced-select">
                                        <option value=""></option>
                                        <option value="pied">pied</option>
                                        <option value="FL">FL</option>
                                        <option value="m√©tre">m√©tre</option>  
                                    </select>
                                </td>
                                <td>
                                    <select name="altitude_autorise" id="altitude_autorise" class="enhanced-select">
                                        <option value=""></option>
                                        <option value="pied">pied</option>
                                        <option value="FL">FL</option>
                                        <option value="m√©tre">m√©tre</option>  
                                    </select>
                                </td>
                                <td><input type="text" name="vitesse" id="vitesse" class="enhanced-input"></td>
                            </tr>
                        </table>
                    </div>
                    
                    <!-- Ligne B -->
                    <h3>B. Deuxi√®me a√©ronef</h3>
                    <div class="table-responsive">
                        <table>
                            <tr>
                                <th>Indicatif et immatriculation</th>
                                <th>Code SSR</th>
                                <th>Type appareil</th>
                                <th>R√®gles de vol</th>
                                <th>Terrain d√©part</th>
                                <th>Terrain arriv√©e</th>
                                <th>Cap</th>
                                <th>Altitude/FL r√©el</th>
                                <th>Altitude/FL autoris√©</th>
                                <th>Vitesse</th>
                            </tr>
                            <tr>
                                <td>
                                    
                                    <input type="text" name="indicatif_immatricultion_b" id="indicatif_immatricultion_b" class="enhanced-input" maxlength="8" onblur="validateIndicatif('indicatif_immatricultion_b', 'indicatif_error_b')">
                                    <div id="indicatif_error_b" class="error_message" style="display: none; color: red; font-size: 0.8em;">
                                        Veuillez entrer un indicateur valide (8 caract√®res)
                                    </div>
                                </td>
                                <td>
                                    <input type="text" name="code_ssr_b" id="code_ssr_b" class="enhanced-input" maxlength="4" onblur="validateMaxLength('code_ssr_b', 'ssr_error_b', 4)">
                                    <div id="ssr_error_b" class="error_message" style="display: none; color: red; font-size: 0.8em;">
                                        Veuillez entrer un code valide (4 caract√®res)
                                    </div>
                                </td>
                                <td>
                                    <input type="text" name="type_appareil_b" id="type_appareil_b" class="enhanced-input" maxlength="4" onblur="validateMaxLength('type_appareil_b', 'type_appareil_error_b', 4)">
                                    <div id="type_appareil_error_b" class="error_message" style="display: none; color: red; font-size: 0.8em;">
                                        Veuillez entrer un type valide (4 caract√®res)
                                    </div>
                                </td>
                                <td>
                                    <select name="regles_vol_b" id="regles_vol_b" class="enhanced-select">
                                        <option value=""></option>
                                        <option value="IFR">IFR</option>
                                        <option value="VFR">VFR</option>
                                        <option value="IFR/VFR">IFR/VFR</option>
                                        <option value="VFR/IFR">VFR/IFR</option>   
                                    </select>
                                </td>
                                <td><input type="text" name="terrain_depart_b" id="terrain_depart_b" class="enhanced-input"></td>
                                <td><input type="text" name="terrain_arriv√©e_b" id="terrain_arriv√©e_b" class="enhanced-input"></td>
                                <td><input type="text" name="cap_b" id="cap_b" class="enhanced-input"></td>
                                <td>
                                    <select name="altitude_reel_b" id="altitude_reel_b" class="enhanced-select">
                                        <option value=""></option>
                                        <option value="pied">pied</option>
                                        <option value="FL">FL</option>
                                        <option value="m√©tre">m√©tre</option>  
                                    </select>
                                </td>
                                <td>
                                    <select name="altitude_autorise_b" id="altitude_autorise_b" class="enhanced-select">
                                        <option value=""></option>
                                        <option value="pied">pied</option>
                                        <option value="FL">FL</option>
                                        <option value="m√©tre">m√©tre</option>  
                                    </select>
                                </td>
                                <td><input type="text" name="vitesse_b" id="vitesse_b" class="enhanced-input"></td>
                            </tr>
                        </table>
                    </div>
                </div>
            </section>

            <!-- Section 3: Nombre de victimes -->
            <section class="collapsible-section">
                <div class="section-header" onclick="toggleSection(this)">
                    <h2><i class="fas fa-user-injured"></i> 3. Nombre estimatif des victimes (si disponible) / ÿπÿØÿØ ÿßŸÑÿ∂ÿ≠ÿßŸäÿß</h2>
                    <span class="toggle-icon"><i class="fas fa-chevron-down"></i></span>
                </div>
                <div class="section-content">
                    <table>
                        <tr>
                            <th>Passagers</th>
                            <th>Personnel</th>
                            <th>Equipage</th>
                            <th>Autre</th>
                        </tr>
                        <tr>
                            <td><input type="number" name="passagers" id="passagers" class="enhanced-input"></td>
                            <td><input type="number" name="personnel" id="personnel" class="enhanced-input"></td>
                            <td><input type="number" name="equipage" id="equipage" class="enhanced-input"></td>
                            <td><input type="number" name="autre" id="autre" class="enhanced-input"></td>
                        </tr>
                    </table>
                </div>
            </section>

            <!-- Section 4: Conditions m√©t√©orologiques -->
            <section class="collapsible-section">
                <div class="section-header" onclick="toggleSection(this)">
                    <h2><i class="fas fa-cloud-rain"></i> 4. Conditions m√©t√©orologiques / ÿßŸÑÿ£ÿ≠ŸàÿßŸÑ ÿßŸÑÿ¨ŸàŸäÿ©</h2>
                    <span class="toggle-icon"><i class="fas fa-chevron-down"></i></span>
                </div>
                <div class="section-content">
                    <table>
                        <tr>
                            <th>Vent</th>
                            <th>Visibilit√©</th>
                            <th>N√©bulosit√©</th>
                            <th>Pr√©cipitation</th>
                            <th>Autres ph√©nom√®nes</th>
                        </tr>
                        <tr>
                            <td>
                                <div class="input-with-icon">
                                    <i class="fas fa-compass"></i>
                                    <input type="text" name="vent_direction" id="vent_direction" placeholder="Direction" class="enhanced-input">
                                </div>
                                <div class="input-with-icon">
                                    <i class="fas fa-wind"></i>
                                    <input type="text" name="vent_vitesse" id="vent_vitesse" placeholder="Vitesse" class="enhanced-input">
                                </div>
                            </td>
                            <td><input type="number" name="visibilite" id="visibilite" class="enhanced-input"></td>
                            <td>
                                <select name="nebulosite" id="nebulosite" class="enhanced-select">
                                    <option value=""></option>
                                    <option value="BKN">BKN</option>
                                    <option value="SCT">SCT</option>
                                    <option value="FEW">FEW</option>
                                    <option value="SKC">SKC</option>
                                    <option value="CB">CB</option>
                                </select>
                            </td>
                            <td>
                                <select name="precipitation" id="precipitation" class="enhanced-select">
                                    <option value=""></option>
                                    <option value="Pluie">Pluie</option>
                                    <option value="Gr√™le">Gr√™le</option>
                                    <option value="Neige">Neige</option>
                                </select>
                            </td>
                            <td><input type="text" name="autres_phenomenes" id="autres_phenomenes" class="enhanced-input"></td>
                        </tr>
                    </table>
                </div>
            </section>

            <!-- Section 5: Mat√©riel, installation ou √©quipement -->
            <section class="collapsible-section">
                <div class="section-header" onclick="toggleSection(this)">
                    <h2><i class="fas fa-tools"></i> 5. Mat√©riel, installation ou √©quipement / ŸÖÿπÿØÿßÿ™ ÿ£Ÿà ÿ™ÿ¨ŸáŸäÿ≤ÿßÿ™ ÿ£Ÿà ÿ£ÿ¨Ÿáÿ≤ÿ©</h2>
                    <span class="toggle-icon"><i class="fas fa-chevron-down"></i></span>
                </div>
                <div class="section-content">
                    <table>
                        <tr>
                            <td>L'√©v√©nement implique une installation/√©quipement</td>
                            <td class="radio-group">
                                <label class="radio-label"><input type="radio" name="evt_implique_installation_√©quipement" value="true"> Oui</label>
                                <label class="radio-label"><input type="radio" name="evt_implique_installation_√©quipement" value="false" checked> Non</label>
                            </td>
                        </tr>
                        <tr>
                            <td>Le type de l'installation ou de l'√©quipement</td>
                            <td><input type="text" name="type_installation_√©quipement" id="type_installation_√©quipement" class="enhanced-input"></td>
                        </tr>
                        <tr>
                            <td>Le nom de la compagnie d'assistance / organisme exploitant le v√©hicule</td>
                            <td><input type="text" name="nom_compagnie_assistance_organisme_exploitant_v√©hicule" id="nom_compagnie_assistance_organisme_exploitant_v√©hicule" class="enhanced-input"></td>
                        </tr>
                        <tr>
                            <td>L'√©v√©nement implique un v√©hicule ou un mat√©riel d'assistance au sol</td>
                            <td class="radio-group">
                                <label class="radio-label"><input type="radio" name="evt_implique_v√©hicule_materiel_assistance_sol" value="true"> Oui</label>
                                <label class="radio-label"><input type="radio" name="evt_implique_v√©hicule_materiel_assistance_sol" value="false" checked> Non</label>
                            </td>
                        </tr>
                        <tr>
                            <td>Type du mat√©riel / v√©hicule</td>
                            <td><input type="text" name="type_materiel_v√©hicule" id="type_materiel_v√©hicule" class="enhanced-input"></td>
                        </tr>
                    </table>
                </div>
            </section>

            <!-- Section 6: Description de l'√©v√©nement -->
            <section class="collapsible-section">
                <div class="section-header" onclick="toggleSection(this)">
                    <h2><i class="fas fa-file-alt"></i> 6. Description de l'√©v√©nement (croquis si n√©cessaire) / ŸàÿµŸÅ ÿßŸÑÿ≠ÿØÿ´</h2>
                    <span class="toggle-icon"><i class="fas fa-chevron-down"></i></span>
                </div>
                <div class="section-content">
                    <textarea name="description_evt" rows="10" cols="100" id="description_evt" class="enhanced-textarea"></textarea>
                    <!-- Ajout du champ statut pour l'admin -->
                    <div style="margin-top: 15px;">
                        <label for="statut">Statut de la FNE:</label>
                        <select name="statut" id="statut" class="enhanced-select">
                            <option value="En attente">En attente</option>
                            <option value="Valid√©">Valid√©</option>
                            <option value="Rejet√©">Refus√©</option>
                        </select>
                    </div>
                </div>
            </section>
            
            <!-- Bouton de soumission -->
            <div class="button-container">
                <button type="submit" class="submit-button">
                    <i class="fas fa-paper-plane"></i> Soumettre
                </button>
            </div>
        </form>
    </div>
</div>
       
    <footer class="footer">
        <div class="footer-content">
            <p>
                La Fiche de Notification d'Ev√©nement (FNE) est un document utilis√© pour signaler et enregistrer les √©v√©nements li√©s √† la s√©curit√© a√©rienne. Elle permet de collecter des informations pr√©cises pour analyser et pr√©venir les incidents futurs.
            </p>
            <div class="contact-info">
                <p>
                    <i class="fab fa-whatsapp"></i>
                    <span>Contactez-nous sur WhatsApp :</span>
                    <a href="https://wa.me/1234567890" target="_blank">+123 456 7890</a>
                </p>
                <p>
                    <i class="fas fa-globe"></i>
                    <span>Visitez le site web de l'OACA :</span>
                    <a href="https://www.oaca.nat.tn/" target="_blank">www.oaca.ma</a>
                </p>
            </div>
        </div>
    </footer>
    <script src="/js/sideBar.js" defer></script> 
    <script src="/js/adminFNE.js"></script>
    <script>
        // Mettre √† jour la date et l'heure toutes les secondes
        setInterval(updateDateTime, 1000);
        // Afficher la date et l'heure imm√©diatement au chargement de la page
        updateDateTime();
        // Afficher Meteo
        fetchMeteo();
        
        // Ouvrir la premi√®re section par d√©faut
        document.addEventListener('DOMContentLoaded', function() {
            // Ouvrir la premi√®re section
            const firstSection = document.querySelector('.collapsible-section');
            if (firstSection) {
                toggleSection(firstSection.querySelector('.section-header'));
            }
        });
        // Check if we're in edit mode from Thymeleaf
    document.addEventListener('DOMContentLoaded', function() {
        const fne = /*[[${fne}]]*/ null;
        if (fne) {
            // We're in edit mode from server-side rendering
            // Update form action and button text
            const form = document.getElementById('fneForm');
            form.action = '/auth/updateFNEAdmin';
            
            const submitButton = document.querySelector('.submit-button');
            if (submitButton) {
                submitButton.innerHTML = '<i class="fas fa-save"></i> Mettre √† jour';
            }
            
            // Show notification that we're in edit mode
            const notification = document.getElementById('notification');
            notification.innerHTML = `<span>Vous √™tes en train de modifier la FNE #${fne.fne_id}</span>`;
            notification.style.display = 'block';
            notification.classList.add('blue');
        }
    });
    </script>
</body>
</html>

